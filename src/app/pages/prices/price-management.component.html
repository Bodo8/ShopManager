
  <div class="container-fluid">
      <h2 class="text-2xl font-bold mb-4">Zarządzanie Cenami</h2>
  </div>
    

      <!-- Wybór sklepu -->
     <div id="first-line-select" class="col-4">
      <select [(ngModel)]="selectedShopId" (change)="loadProducts()" class="form-select form-select-lg mb-3" aria-label="Large select example">
        <option [value]="0">- wybierz sklep -</option>
        <option *ngFor="let shop of shops()" [value]="shop.id">{{ shop.name }}</option>
      </select>
     </div>

     <div *ngIf="products().length > 0" class="table-responsive mt-4">
  <table class="table table-bordered align-middle shadow-sm bg-white">
    <thead class="table-primary">
      <tr>
        <th style="width: 30%">Produkt</th>
        <th style="width: 15%">Cena bazowa</th>
        <th style="width: 35%">Dostępne rabaty</th>
        <th style="width: 20%">Cena po rabacie</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of products()">
        <!-- Nazwa i opis produktu -->
        <td>
            <span
                class="fw-semibold text-primary"
                data-bs-toggle="tooltip"
                data-bs-placement="right"
                [attr.title]="product.description"
            >
                {{ product.name }}
            </span>
        </td>

        <!-- Cena bazowa -->
        <td>
          <strong>{{ product.prices[0]?.basePrice | number:'1.2-2' }} zł</strong>
        </td>

        <!-- Rabaty -->
        <td>
          <div *ngFor="let discount of product.discounts" class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              [id]="'discount-' + product.id + '-' + discount.id"
              (change)="toggleDiscount(product.id, discount, $event)"
            />
            <label
              class="form-check-label"
              [for]="'discount-' + product.id + '-' + discount.id"
            >
              {{ discount.description }} ({{ discount.percentage }}%)
            </label>
          </div>
        </td>

        <!-- Cena po rabacie -->
        <td>
          <ng-container *ngIf="finalPrices()[product.id]; else noDiscount">
            <span class="text-success fw-bold">
              {{ finalPrices()[product.id] | number:'1.2-2' }} zł
            </span>
          </ng-container>
          <ng-template #noDiscount>
            <span class="text-secondary">–</span>
          </ng-template>
        </td>
      </tr>
    </tbody>
  </table>